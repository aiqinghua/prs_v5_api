2024-05-09 23:45:28 [INFO] [conftest.py] 第21行 : 收集到的测试用例为：[<Function test_allrisk[cases0]>, <Function test_allrisk[cases1]>, <Function test_allrisk[cases2]>, <Function test_attackchain[cases0]>, <Function test_attackchain[cases1]>, <Function test_attackchain[cases2]>, <Function test_attacker[cases0]>, <Function test_attacker[cases1]>, <Function test_attacker[cases2]>, <Function test_attackerarea[cases0]>, <Function test_attackerarea[cases1]>, <Function test_attackerarea[cases2]>, <Function test_getYarnmetricsInfo[cases0]>, <Function test_riskasste[cases0]>, <Function test_riskasste[cases1]>, <Function test_riskasste[cases2]>, <Function test_risktrend[cases0]>, <Function test_risktrend[cases1]>, <Function test_risktrend[cases2]>, <Function test_sensorinfo[cases0]>, <Function test_todoasset[cases0]>, <Function test_todoasset[cases1]>, <Function test_todoasset[cases2]>]
2024-05-09 23:45:28 [INFO] [conftest.py] 第22行 : 收集到的用例数量为：23
2024-05-09 23:45:29 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/allRisk】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714665600000, 1715269528620]}
2024-05-09 23:45:29 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'riskSumCount': 173921, 'attackSuccess': 7553, 'todayNewRiskCount': 7396, 'outsideAttack': 1106, 'lateralAttack': 167066, 'outreachAttack': 3926}, 'code': 20000}
2024-05-09 23:45:29 [INFO] [test_allrisk.py] 第30行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:29 [INFO] [ck_query_util.py] 第27行 : CK查询结果为：{'riskall': 173921, 'newaddrisk': 7396, 'successattackrisk': 7553}
2024-05-09 23:45:29 [INFO] [test_allrisk.py] 第54行 : 用例--【获取最近7天的全部风险】--执行成功
2024-05-09 23:45:29 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/allRisk】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714924800000, 1715269529449]}
2024-05-09 23:45:29 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'riskSumCount': 173921, 'attackSuccess': 7553, 'todayNewRiskCount': 7396, 'outsideAttack': 1106, 'lateralAttack': 167066, 'outreachAttack': 3926}, 'code': 20000}
2024-05-09 23:45:29 [INFO] [test_allrisk.py] 第30行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:30 [INFO] [ck_query_util.py] 第27行 : CK查询结果为：{'riskall': 173921, 'newaddrisk': 7396, 'successattackrisk': 7553}
2024-05-09 23:45:30 [INFO] [test_allrisk.py] 第54行 : 用例--【获取最近3天的全部风险】--执行成功
2024-05-09 23:45:30 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/allRisk】, 请求数据类型为：【json】, 请求数据为：{'ts': [1715184000000, 1715269530103]}
2024-05-09 23:45:30 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'riskSumCount': 7396, 'attackSuccess': 0, 'todayNewRiskCount': 7396, 'outsideAttack': 394, 'lateralAttack': 6005, 'outreachAttack': 997}, 'code': 20000}
2024-05-09 23:45:30 [INFO] [test_allrisk.py] 第30行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:30 [INFO] [ck_query_util.py] 第27行 : CK查询结果为：{'riskall': 7396, 'newaddrisk': 7396, 'successattackrisk': 0}
2024-05-09 23:45:30 [INFO] [test_allrisk.py] 第54行 : 用例--【获取最近1天的全部风险】--执行成功
2024-05-09 23:45:31 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/attackChain】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714665600000, 1715269530777]}
2024-05-09 23:45:31 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': [{'phase': 1, 'count': 32388, 'isSuccessCount': 6741}, {'phase': 2, 'count': 116985, 'isSuccessCount': 582}, {'phase': 3, 'count': 23277, 'isSuccessCount': 224}, {'phase': 4, 'count': 559, 'isSuccessCount': 0}, {'phase': 5, 'count': 385, 'isSuccessCount': 0}], 'code': 20000}
2024-05-09 23:45:31 [INFO] [test_attackchain.py] 第28行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:31 [INFO] [ck_query_util.py] 第42行 : CK查询结果为：[(1, 32388, 6741), (2, 116985, 582), (3, 23277, 224), (4, 559, 0), (5, 385, 0)]
2024-05-09 23:45:31 [INFO] [test_attackchain.py] 第58行 : 用例--【获取最近7天的攻击链】--执行成功
2024-05-09 23:45:31 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/attackChain】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714924800000, 1715269531424]}
2024-05-09 23:45:31 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': [{'phase': 1, 'count': 32388, 'isSuccessCount': 6741}, {'phase': 2, 'count': 116985, 'isSuccessCount': 582}, {'phase': 3, 'count': 23277, 'isSuccessCount': 224}, {'phase': 4, 'count': 559, 'isSuccessCount': 0}, {'phase': 5, 'count': 385, 'isSuccessCount': 0}], 'code': 20000}
2024-05-09 23:45:31 [INFO] [test_attackchain.py] 第28行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:32 [INFO] [ck_query_util.py] 第42行 : CK查询结果为：[(1, 32388, 6741), (2, 116985, 582), (3, 23277, 224), (4, 559, 0), (5, 385, 0)]
2024-05-09 23:45:32 [INFO] [test_attackchain.py] 第58行 : 用例--【获取最近3天的攻击链】--执行成功
2024-05-09 23:45:32 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/attackChain】, 请求数据类型为：【json】, 请求数据为：{'ts': [1715184000000, 1715269532037]}
2024-05-09 23:45:32 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': [{'phase': 1, 'count': 7305, 'isSuccessCount': 0}, {'phase': 2, 'count': 49, 'isSuccessCount': 0}, {'phase': 3, 'count': 40, 'isSuccessCount': 0}, {'phase': 4, 'count': 2, 'isSuccessCount': 0}, {'phase': 5, 'count': 0, 'isSuccessCount': 0}], 'code': 20000}
2024-05-09 23:45:32 [INFO] [test_attackchain.py] 第28行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:32 [INFO] [ck_query_util.py] 第42行 : CK查询结果为：[(1, 7305, 0), (2, 49, 0), (3, 40, 0), (4, 2, 0)]
2024-05-09 23:45:32 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/attacker】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714665600000, 1715269532627]}
2024-05-09 23:45:32 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'attackerCount': 772, 'internalAttackerCount': 709, 'externalAttackerCount': 63, 'domesticCount': 0, 'overseasCount': 0}, 'code': 20000}
2024-05-09 23:45:32 [INFO] [test_attacker.py] 第35行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:32 [INFO] [test_attacker.py] 第54行 : 用例--【获取最近7天的攻击者】--执行成功
2024-05-09 23:45:33 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/attacker】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714924800000, 1715269532837]}
2024-05-09 23:45:33 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'attackerCount': 772, 'internalAttackerCount': 709, 'externalAttackerCount': 63, 'domesticCount': 0, 'overseasCount': 0}, 'code': 20000}
2024-05-09 23:45:33 [INFO] [test_attacker.py] 第35行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:33 [INFO] [test_attacker.py] 第54行 : 用例--【获取最近3天的攻击者】--执行成功
2024-05-09 23:45:33 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/attacker】, 请求数据类型为：【json】, 请求数据为：{'ts': [1715184000000, 1715269533135]}
2024-05-09 23:45:33 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'attackerCount': 136, 'internalAttackerCount': 87, 'externalAttackerCount': 49, 'domesticCount': 0, 'overseasCount': 0}, 'code': 20000}
2024-05-09 23:45:33 [INFO] [test_attacker.py] 第35行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:33 [INFO] [test_attacker.py] 第54行 : 用例--【获取最近1天的攻击者】--执行成功
2024-05-09 23:45:33 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/attackerArea】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714665600000, 1715269533639]}
2024-05-09 23:45:33 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': [{'area': '中国', 'longitude': 106.7167, 'latitude': 26.5833, 'count': 15}, {'area': '美国', 'longitude': -97.822, 'latitude': 37.751, 'count': 9}, {'area': '中国北京', 'longitude': 116.3889, 'latitude': 39.9288, 'count': 9}, {'area': '中国广州', 'longitude': 113.25, 'latitude': 23.1167, 'count': 4}, {'area': '中国上海', 'longitude': 121.4012, 'latitude': 31.0449, 'count': 3}, {'area': '中国深圳市', 'longitude': 114.1333, 'latitude': 22.5333, 'count': 3}, {'area': '日本', 'longitude': 139.69, 'latitude': 35.69, 'count': 3}, {'area': '中国杭州', 'longitude': 120.1619, 'latitude': 30.294, 'count': 2}, {'area': '中国昆明', 'longitude': 102.7183, 'latitude': 25.0389, 'count': 1}, {'area': '日本东京', 'longitude': 139.7532, 'latitude': 35.6882, 'count': 1}], 'code': 20000}
2024-05-09 23:45:33 [INFO] [test_attackerarea.py] 第34行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:33 [INFO] [test_attackerarea.py] 第52行 : 用例--【获取最近7天的攻击者分布】--执行成功
2024-05-09 23:45:34 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/attackerArea】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714924800000, 1715269533835]}
2024-05-09 23:45:34 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': [{'area': '中国', 'longitude': 106.7167, 'latitude': 26.5833, 'count': 15}, {'area': '美国', 'longitude': -97.822, 'latitude': 37.751, 'count': 9}, {'area': '中国北京', 'longitude': 116.3889, 'latitude': 39.9288, 'count': 9}, {'area': '中国广州', 'longitude': 113.25, 'latitude': 23.1167, 'count': 4}, {'area': '中国上海', 'longitude': 121.4012, 'latitude': 31.0449, 'count': 3}, {'area': '中国深圳市', 'longitude': 114.1333, 'latitude': 22.5333, 'count': 3}, {'area': '日本', 'longitude': 139.69, 'latitude': 35.69, 'count': 3}, {'area': '中国杭州', 'longitude': 120.1619, 'latitude': 30.294, 'count': 2}, {'area': '中国昆明', 'longitude': 102.7183, 'latitude': 25.0389, 'count': 1}, {'area': '日本东京', 'longitude': 139.7532, 'latitude': 35.6882, 'count': 1}], 'code': 20000}
2024-05-09 23:45:34 [INFO] [test_attackerarea.py] 第34行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:34 [INFO] [test_attackerarea.py] 第52行 : 用例--【获取最近3天的攻击者分布】--执行成功
2024-05-09 23:45:34 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/ckSecurityOverview/attackerArea】, 请求数据类型为：【json】, 请求数据为：{'ts': [1715184000000, 1715269534110]}
2024-05-09 23:45:34 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': [{'area': '中国', 'longitude': 106.7167, 'latitude': 26.5833, 'count': 14}, {'area': '中国北京', 'longitude': 116.3889, 'latitude': 39.9288, 'count': 9}, {'area': '美国', 'longitude': -97.822, 'latitude': 37.751, 'count': 6}, {'area': '中国广州', 'longitude': 113.25, 'latitude': 23.1167, 'count': 4}, {'area': '中国深圳市', 'longitude': 114.1333, 'latitude': 22.5333, 'count': 3}, {'area': '日本', 'longitude': 139.69, 'latitude': 35.69, 'count': 3}, {'area': '中国上海', 'longitude': 121.4012, 'latitude': 31.0449, 'count': 1}, {'area': '中国昆明', 'longitude': 102.7183, 'latitude': 25.0389, 'count': 1}, {'area': '日本东京', 'longitude': 139.7532, 'latitude': 35.6882, 'count': 1}, {'area': '荷兰', 'longitude': 5.3077, 'latitude': 51.7266, 'count': 1}], 'code': 20000}
2024-05-09 23:45:34 [INFO] [test_attackerarea.py] 第34行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:34 [INFO] [test_attackerarea.py] 第52行 : 用例--【获取最近1天的攻击者分布】--执行成功
2024-05-09 23:45:35 [INFO] [send_request_util.py] 第44行 : 请求方法为：【get】, 请求地址为：【https://10.0.81.124/nta/api/monitorClient/getYarnMetricsInfo】, 请求数据类型为：【params】, 请求数据为：None
2024-05-09 23:45:35 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'appsSubmitted': 10, 'appsCompleted': 0, 'appsPending': 0, 'appsRunning': 8, 'appsFailed': 0, 'appsKilled': 2, 'reservedMB': 0, 'availableMB': 86025, 'allocatedMB': 149504, 'reservedVirtualCores': 0, 'availableVirtualCores': 37, 'allocatedVirtualCores': 59, 'containersAllocated': 28, 'containersReserved': 0, 'containersPending': 0, 'totalMB': 235529, 'totalVirtualCores': 96, 'totalNodes': 3, 'lostNodes': 0, 'unhealthyNodes': 0, 'decommissioningNodes': 0, 'decommissionedNodes': 0, 'rebootedNodes': 0, 'activeNodes': 3, 'shutdownNodes': 0, 'totalUsedResourcesAcrossPartition': {'memory': 149504, 'vCores': 59, 'resourceInformations': {'resourceInformation': [{'maximumAllocation': 9223372036854775807, 'minimumAllocation': 0, 'name': 'memory-mb', 'resourceType': 'COUNTABLE', 'units': 'Mi', 'value': 149504}, {'maximumAllocation': 9223372036854775807, 'minimumAllocation': 0, 'name': 'vcores', 'resourceType': 'COUNTABLE', 'units': '', 'value': 59}]}}, 'totalClusterResourcesAcrossPartition': {'memory': 235529, 'vCores': 96, 'resourceInformations': {'resourceInformation': [{'maximumAllocation': 9223372036854775807, 'minimumAllocation': 0, 'name': 'memory-mb', 'resourceType': 'COUNTABLE', 'units': 'Mi', 'value': 235529}, {'maximumAllocation': 9223372036854775807, 'minimumAllocation': 0, 'name': 'vcores', 'resourceType': 'COUNTABLE', 'units': '', 'value': 96}]}}, 'availableKb': 90203750400, 'totalKb': 246970056704, 'allocatedKb': 156766306304, 'allStorage': 49137174645309, 'useStorage': 65970697666}, 'code': 20000}
2024-05-09 23:45:35 [INFO] [test_getYarnMetricsInfo.py] 第26行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:35 [INFO] [test_getYarnMetricsInfo.py] 第39行 : 用例--【获取集群资源】--执行成功
2024-05-09 23:45:35 [INFO] [send_request_util.py] 第44行 : 请求方法为：【get】, 请求地址为：【https://10.0.81.124/nta/asset/ck/security_overview/riskAsset】, 请求数据类型为：【params】, 请求数据为：{'ts': [1714665600000, 1715269535146]}
2024-05-09 23:45:35 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'assetTotal': 1869, 'fallAssetTotle': 48, 'serverAssetTotle': 0, 'clientAssetTotle': 7}, 'code': 20000}
2024-05-09 23:45:35 [INFO] [test_riskAsset.py] 第26行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:35 [INFO] [test_riskAsset.py] 第44行 : 用例--【获取最近7天的资产风险】--执行成功
2024-05-09 23:45:35 [INFO] [send_request_util.py] 第44行 : 请求方法为：【get】, 请求地址为：【https://10.0.81.124/nta/asset/ck/security_overview/riskAsset】, 请求数据类型为：【params】, 请求数据为：{'ts': [1714924800000, 1715269535400]}
2024-05-09 23:45:35 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'assetTotal': 1869, 'fallAssetTotle': 48, 'serverAssetTotle': 0, 'clientAssetTotle': 7}, 'code': 20000}
2024-05-09 23:45:35 [INFO] [test_riskAsset.py] 第26行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:35 [INFO] [test_riskAsset.py] 第44行 : 用例--【获取最近3天的资产风险】--执行成功
2024-05-09 23:45:36 [INFO] [send_request_util.py] 第44行 : 请求方法为：【get】, 请求地址为：【https://10.0.81.124/nta/asset/ck/security_overview/riskAsset】, 请求数据类型为：【params】, 请求数据为：{'ts': [1715184000000, 1715269535869]}
2024-05-09 23:45:36 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'assetTotal': 1416, 'fallAssetTotle': 36, 'serverAssetTotle': 0, 'clientAssetTotle': 7}, 'code': 20000}
2024-05-09 23:45:36 [INFO] [test_riskAsset.py] 第26行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:36 [INFO] [test_riskAsset.py] 第44行 : 用例--【获取最近1天的资产风险】--执行成功
2024-05-09 23:45:36 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/risk/ckRisk/riskTrend】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714665600000, 1715269536559], 'ignore': False}
2024-05-09 23:45:36 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'x': ['1714665600000', '1714752000000', '1714838400000', '1714924800000', '1715011200000', '1715097600000', '1715184000000'], 'y': [{'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 15835, 'critical': 0, 'low': 114983, 'medium': 35024}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 3186, 'medium': 4210}]}, 'code': 20000}
2024-05-09 23:45:36 [INFO] [test_risktrend.py] 第25行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:36 [INFO] [test_risktrend.py] 第43行 : 用例--【获取最近7天的风险趋势图】--执行成功
2024-05-09 23:45:37 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/risk/ckRisk/riskTrend】, 请求数据类型为：【json】, 请求数据为：{'ts': [1714924800000, 1715269536833], 'ignore': False}
2024-05-09 23:45:37 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'x': ['1714924800000', '1715011200000', '1715097600000', '1715184000000'], 'y': [{'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 15835, 'critical': 0, 'low': 114983, 'medium': 35024}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 3186, 'medium': 4210}]}, 'code': 20000}
2024-05-09 23:45:37 [INFO] [test_risktrend.py] 第25行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:37 [INFO] [test_risktrend.py] 第43行 : 用例--【获取最近3天的风险趋势图】--执行成功
2024-05-09 23:45:37 [INFO] [send_request_util.py] 第44行 : 请求方法为：【post】, 请求地址为：【https://10.0.81.124/nta/api/risk/ckRisk/riskTrend】, 请求数据类型为：【json】, 请求数据为：{'ts': [1715184000000, 1715269537119], 'ignore': False}
2024-05-09 23:45:37 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': {'x': ['1715184000000', '1715187600000', '1715191200000', '1715194800000', '1715198400000', '1715202000000', '1715205600000', '1715209200000', '1715212800000', '1715216400000', '1715220000000', '1715223600000', '1715227200000', '1715230800000', '1715234400000', '1715238000000', '1715241600000', '1715245200000', '1715248800000', '1715252400000', '1715256000000', '1715259600000', '1715263200000', '1715266800000'], 'y': [{'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 0, 'medium': 0}, {'high': 0, 'critical': 0, 'low': 440, 'medium': 628}, {'high': 0, 'critical': 0, 'low': 541, 'medium': 719}, {'high': 0, 'critical': 0, 'low': 618, 'medium': 725}, {'high': 0, 'critical': 0, 'low': 573, 'medium': 726}, {'high': 0, 'critical': 0, 'low': 534, 'medium': 725}, {'high': 0, 'critical': 0, 'low': 474, 'medium': 682}, {'high': 0, 'critical': 0, 'low': 6, 'medium': 5}]}, 'code': 20000}
2024-05-09 23:45:37 [INFO] [test_risktrend.py] 第25行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:37 [INFO] [test_risktrend.py] 第43行 : 用例--【获取最近1天的风险趋势图】--执行成功
2024-05-09 23:45:37 [INFO] [send_request_util.py] 第44行 : 请求方法为：【get】, 请求地址为：【https://10.0.81.124/pm/system/sensorInfo?host=prs-sensor】, 请求数据类型为：【params】, 请求数据为：None
2024-05-09 23:45:37 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'code': 20000, 'message': '操作成功', 'data': {'cpu_total': 32, 'cpu_used': 2, 'cpu_percent': 4.94, 'disk_total': 4053519491072, 'disk_avail': 1332995846144, 'disk_percent': 67.12, 'memory_total': 135141814272, 'memory_avail': 36966289408, 'memory_percent': 72.65}}
2024-05-09 23:45:37 [INFO] [test_sensorinfo.py] 第26行 : 预期结果为：{'code': 20000, 'message': '操作成功'}
2024-05-09 23:45:37 [INFO] [test_sensorinfo.py] 第40行 : 用例--【获取sensor资源】--执行成功
2024-05-09 23:45:37 [INFO] [send_request_util.py] 第44行 : 请求方法为：【get】, 请求地址为：【https://10.0.81.124/nta/asset/ck/security_overview/todoAsset】, 请求数据类型为：【params】, 请求数据为：{'ts': [1714665600000, 1715269537592]}
2024-05-09 23:45:37 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': [{'riskTotal': 5980, 'assetIp': '10.0.86.116', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 4074}, {'riskName': 'HTTP异常', 'riskTotal': 1516}, {'riskName': 'SQL注入', 'riskTotal': 6}]}, {'riskTotal': 5751, 'assetIp': '10.0.81.48', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': []}, {'riskTotal': 4241, 'assetIp': '10.0.86.12', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 2776}, {'riskName': 'HTTP异常', 'riskTotal': 6}]}, {'riskTotal': 3911, 'assetIp': '10.0.86.11', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 3086}, {'riskName': 'HTTP异常', 'riskTotal': 326}, {'riskName': '远控工具', 'riskTotal': 6}]}, {'riskTotal': 3426, 'assetIp': '10.0.86.112', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 3338}, {'riskName': 'DNS外带', 'riskTotal': 39}]}, {'riskTotal': 3247, 'assetIp': '192.168.199.155', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '敏感文件泄露', 'riskTotal': 2530}, {'riskName': 'SQL注入', 'riskTotal': 420}, {'riskName': '服务端信息泄露', 'riskTotal': 383}]}, {'riskTotal': 2870, 'assetIp': '10.0.86.16', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 2310}, {'riskName': 'HTTP异常', 'riskTotal': 391}, {'riskName': '权限绕过', 'riskTotal': 8}]}, {'riskTotal': 2511, 'assetIp': '10.0.85.241', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'WEBSHELL', 'riskTotal': 1274}, {'riskName': '命令执行', 'riskTotal': 623}, {'riskName': '文件上传', 'riskTotal': 245}]}, {'riskTotal': 1993, 'assetIp': '14.152.76.63', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'HTTP异常', 'riskTotal': 390}]}, {'riskTotal': 1406, 'assetIp': '10.0.81.124', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'HTTP异常', 'riskTotal': 2}]}], 'code': 20000}
2024-05-09 23:45:37 [INFO] [test_todoasset.py] 第30行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:37 [INFO] [test_todoasset.py] 第49行 : 用例--【获取最近7天的风险资产top10】--执行成功
2024-05-09 23:45:38 [INFO] [send_request_util.py] 第44行 : 请求方法为：【get】, 请求地址为：【https://10.0.81.124/nta/asset/ck/security_overview/todoAsset】, 请求数据类型为：【params】, 请求数据为：{'ts': [1714924800000, 1715269537801]}
2024-05-09 23:45:38 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': [{'riskTotal': 5980, 'assetIp': '10.0.86.116', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 4074}, {'riskName': 'HTTP异常', 'riskTotal': 1516}, {'riskName': 'SQL注入', 'riskTotal': 6}]}, {'riskTotal': 5751, 'assetIp': '10.0.81.48', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': []}, {'riskTotal': 4241, 'assetIp': '10.0.86.12', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 2776}, {'riskName': 'HTTP异常', 'riskTotal': 6}]}, {'riskTotal': 3911, 'assetIp': '10.0.86.11', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 3086}, {'riskName': 'HTTP异常', 'riskTotal': 326}, {'riskName': '远控工具', 'riskTotal': 6}]}, {'riskTotal': 3427, 'assetIp': '10.0.86.112', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 3338}, {'riskName': 'DNS外带', 'riskTotal': 40}]}, {'riskTotal': 3247, 'assetIp': '192.168.199.155', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '敏感文件泄露', 'riskTotal': 2530}, {'riskName': 'SQL注入', 'riskTotal': 420}, {'riskName': '服务端信息泄露', 'riskTotal': 383}]}, {'riskTotal': 2870, 'assetIp': '10.0.86.16', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 2310}, {'riskName': 'HTTP异常', 'riskTotal': 391}, {'riskName': '权限绕过', 'riskTotal': 8}]}, {'riskTotal': 2511, 'assetIp': '10.0.85.241', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'WEBSHELL', 'riskTotal': 1274}, {'riskName': '命令执行', 'riskTotal': 623}, {'riskName': '文件上传', 'riskTotal': 245}]}, {'riskTotal': 1993, 'assetIp': '14.152.76.63', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'HTTP异常', 'riskTotal': 390}]}, {'riskTotal': 1406, 'assetIp': '10.0.81.124', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'HTTP异常', 'riskTotal': 2}]}], 'code': 20000}
2024-05-09 23:45:38 [INFO] [test_todoasset.py] 第30行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:38 [INFO] [test_todoasset.py] 第49行 : 用例--【获取最近3天的风险资产top10】--执行成功
2024-05-09 23:45:38 [INFO] [send_request_util.py] 第44行 : 请求方法为：【get】, 请求地址为：【https://10.0.81.124/nta/asset/ck/security_overview/todoAsset】, 请求数据类型为：【params】, 请求数据为：{'ts': [1715184000000, 1715269538803]}
2024-05-09 23:45:38 [INFO] [send_request_util.py] 第46行 : 实际结果为：{'message': '请求成功!', 'data': [{'riskTotal': 5885, 'assetIp': '10.0.86.116', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 3989}, {'riskName': 'HTTP异常', 'riskTotal': 1506}, {'riskName': 'SQL注入', 'riskTotal': 6}]}, {'riskTotal': 4082, 'assetIp': '10.0.86.12', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 2682}]}, {'riskTotal': 3789, 'assetIp': '10.0.86.11', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 2998}, {'riskName': 'HTTP异常', 'riskTotal': 317}, {'riskName': '远控工具', 'riskTotal': 6}]}, {'riskTotal': 3334, 'assetIp': '10.0.86.112', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 3248}, {'riskName': 'DNS外带', 'riskTotal': 40}]}, {'riskTotal': 2756, 'assetIp': '10.0.86.16', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': '源码泄露', 'riskTotal': 2221}, {'riskName': 'HTTP异常', 'riskTotal': 371}, {'riskName': '权限绕过', 'riskTotal': 8}]}, {'riskTotal': 1938, 'assetIp': '14.152.76.63', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'HTTP异常', 'riskTotal': 388}]}, {'riskTotal': 1406, 'assetIp': '10.0.81.124', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'HTTP异常', 'riskTotal': 2}]}, {'riskTotal': 1176, 'assetIp': '10.0.81.51', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': []}, {'riskTotal': 1022, 'assetIp': '120.199.94.22', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'HTTP异常', 'riskTotal': 44}]}, {'riskTotal': 996, 'assetIp': '10.0.89.17', 'assetTag': '1', 'riskLevel': None, 'assetRiskClassifyList': [{'riskName': 'HTTP异常', 'riskTotal': 762}, {'riskName': '远控工具', 'riskTotal': 7}, {'riskName': '权限绕过', 'riskTotal': 4}]}], 'code': 20000}
2024-05-09 23:45:38 [INFO] [test_todoasset.py] 第30行 : 预期结果为：{'message': '请求成功!', 'code': 20000}
2024-05-09 23:45:38 [INFO] [test_todoasset.py] 第49行 : 用例--【获取最近1天的风险资产top10】--执行成功
